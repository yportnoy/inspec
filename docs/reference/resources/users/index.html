<!DOCTYPE html><html><head><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><meta charset="utf-8" /><meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport" /><link href="/favicon.png" rel="icon" type="image/png" /><link href="/favicon.ico" rel="icon" /><title>About the users Resource</title><link href="//fonts.googleapis.com/css?family=Lato:300,400" rel="stylesheet" type="text/css" /><link href="css/inspec_tutorial.css" rel="stylesheet" type="text/css" /><link href="/stylesheets/site.css" rel="stylesheet" /></head><body class="docs docs_reference docs_reference_resources docs_reference_resources_users docs_reference_resources_users_index"><div id="global-message"><div class="container"><div class="row"><div class="columns small-8 medium-8 medium-push-2 medium-text-center"><a href="https://www.chef.io/webinars/?commid=225819" target="_blank"><strong>Watch the Recorded Webcast â€“ Compliance as Code with InSpec 1.0 Oct 25</strong> View now!</a></div><div class="columns small-4 medium-2 text-right"><span class="dismiss-button"><i class="fa fa-times-circle-o"></i>Dismiss</span></div></div></div></div><script>gm_session_id = 'inspecGlobalMessage2';</script><div class="container"><nav class="sidebar-layout-docs" id="main-nav"><a class="main-nav--logo" href="/"><img onerror="this.src='/images/inspec-by-chef-logo.png'" src="/images/inspec-by-chef-logo.svg" /></a><svg class="main-nav--toggle" style="enable-background:new 0 0 25.8 23.8;" viewBox="0 0 25.8 23.8" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"><g><path d="M0,19h25.8v4.7H0V19z M25.8,14.6H2.7V9.9h23.1V14.6z M25.8,4.7H0.1V0h25.7V4.7z"></path></g></svg><ul class="main-nav--links"><li class="main-nav--link-ctas"><a class="button transparent try-demo" href="#">Try the Demo</a><a class="button secondary" href="https://downloads.chef.io/inspec">Download</a></li><li class="main-nav--sidebar"><form action="/docs/search/" class="main-sidebar--search" method="get"><input name="q" placeholder="Search Documentation" type="text" /></form><ul class="main-sidebar--links"><li class="main-sidebar--link"><h6>Getting Started</h6><ul class="main-sidebar--list no-bullet"><li class="main-sidebar--list--item"><a href="/docs">Overview</a></li><li class="main-sidebar--list--item"><a href="https://downloads.chef.io/inspec">Get InSpec</a></li><li class="main-sidebar--list--item"><a href="/docs/tutorials">Tutorials</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/inspec_and_friends">InSpec and friends</a></li></ul></li><li class="main-sidebar--link"><h6>Reference</h6><ul class="main-sidebar--list no-bullet"><li class="main-sidebar--list--item"><a href="/docs/reference/cli">inspec executable</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/profiles">Profiles</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/resources">Resources</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/matchers">Matchers</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/dsl_inspec">InSpec DSL</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/dsl_resource">Resource DSL</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/plugin_kitchen_inspec.html">kitchen-inspec</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/shell">inspec shell</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/ruby_usage">Ruby usage</a></li></ul></li></ul></li></ul></nav><nav id="main-nav-ctas"><a class="button transparent try-demo" href="#">Try the Demo</a><a class="button secondary" href="https://downloads.chef.io/inspec">Download</a></nav><main id="main-content"><h1>users</h1>

<p>Use the <code>users</code> InSpec audit resource to look up all local users available on the system, and then test specific properties of those users. This resource does not return information about users that may be located on other systems, such as LDAP or Active Directory.</p>

<h2>Syntax</h2>

<p>A <code>users</code> resource block declares a user name, and then one (or more) matchers:</p>
<pre class="highlight plaintext"><code>describe users.where(uid: 0).entries do
  it { should eq ['root'] }
  its('uids') { should eq [1234] }
  its('gids') { should eq [1234] }
end
</code></pre>
<p>where</p>

<ul>
<li><code>gid</code>, <code>group</code>, <code>groups</code>, <code>home</code>, <code>maxdays</code>, <code>mindays</code>, <code>shell</code>, <code>uid</code>, and <code>warndays</code> are valid matchers for this resource</li>
<li><code>where(uid: 0).entries</code> represents a filter that runs the test only against matching users</li>
</ul>

<p>For example:</p>
<pre class="highlight plaintext"><code>describe users.where { username =~ /.*/ } do
  it { should exist }
end
</code></pre>
<p>or:</p>
<pre class="highlight plaintext"><code>describe users.where { uid =~ /^S-1-5-[0-9-]+-501$/ } do
  it { should exist }
end
</code></pre>
<h2>Matchers</h2>

<p>This InSpec audit resource has the following matchers:</p>

<h3>be</h3>

<p>Use the <code>be</code> matcher to use a comparison operator&mdash;<code>=</code> (equal to), <code>&gt;</code> (greater than), <code>&lt;</code> (less than), <code>&gt;=</code> (greater than or equal to), and <code>&lt;=</code> (less than or equal to)&mdash;to compare two values: <code>its(&#39;value&#39;) { should be &gt;= value }</code>, <code>its(&#39;value&#39;) { should be &lt; value }</code>, and so on.</p>

<h3>cmp</h3>

<p>Use the <code>cmp</code> matcher compare two values, such as comparing strings to numbers, comparing a single value to an array of values, comparing an array of strings to a regular expression, improving the printing of octal values, and comparing while ignoring case sensitivity.</p>

<p>Compare a single value to an array:</p>
<pre class="highlight plaintext"><code>describe some_resource do
  its('users') { should cmp 'root' }
  its('users') { should cmp ['root'] }
end
</code></pre>
<p>Compare strings and regular expressions:</p>
<pre class="highlight plaintext"><code>describe some_resource do
  its('setting') { should cmp /raw/i }
end
</code></pre>
<p>Compare strings and numbers:</p>
<pre class="highlight plaintext"><code>describe some_resource do
  its('setting') { should eq '2' }
end
</code></pre>
<p>vs:</p>
<pre class="highlight plaintext"><code>describe some_resource do
  its('setting') { should cmp '2' }
  its('setting') { should cmp 2 }
end
</code></pre>
<p>Ignoring case sensitivity:</p>

<p>describe some_resource do
     its(&lsquo;setting&rsquo;) { should cmp &#39;raw&rsquo; }
     its(&#39;setting&rsquo;) { should cmp &#39;RAW&rsquo; }
   end</p>

<p>Printing octal values:</p>
<pre class="highlight plaintext"><code>describe some_resource('/proc/cpuinfo') do
  its('mode') { should cmp '0345' }
end

expected: 0345
got: 0444
</code></pre>
<h3>eq</h3>

<p>Use the <code>eq</code> matcher to test the equality of two values: <code>its(&#39;Port&#39;) { should eq &#39;22&#39; }</code>.</p>

<p>Using <code>its(&#39;Port&#39;) { should eq 22 }</code> will fail because <code>22</code> is not a string value! Use the <code>cmp</code> matcher for less restrictive value comparisons.</p>

<h3>exist</h3>

<p>The <code>exist</code> matcher tests if the named user exists:</p>
<pre class="highlight plaintext"><code>it { should exist }
</code></pre>
<h3>gid</h3>

<p>The <code>gid</code> matcher tests the group identifier:</p>
<pre class="highlight plaintext"><code>its('gid') { should eq 1234 } }
</code></pre>
<p>where <code>1234</code> represents the user identifier.</p>

<h3>group</h3>

<p>The <code>group</code> matcher tests the group to which the user belongs:</p>
<pre class="highlight plaintext"><code>its('group') { should eq 'root' }
</code></pre>
<p>where <code>root</code> represents the group.</p>

<h3>groups</h3>

<p>The <code>groups</code> matcher tests two (or more) groups to which the user belongs:</p>
<pre class="highlight plaintext"><code>its('groups') { should eq ['root', 'other']}
</code></pre>
<h3>home</h3>

<p>The <code>home</code> matcher tests the home directory path for the user:</p>
<pre class="highlight plaintext"><code>its('home') { should eq '/root' }
</code></pre>
<h3>include</h3>

<p>Use the <code>include</code> matcher to verify that a string value is included in a list: <code>its(&#39;list&#39;) { should include &#39;string&#39; }</code>.</p>

<h3>match</h3>

<p>Use the <code>match</code> matcher to check if a string matches a regular expression: <code>its(&#39;string&#39;) { should_not match /regex/ }</code>.</p>

<h3>maxdays</h3>

<p>The <code>maxdays</code> matcher tests the maximum number of days between password changes:</p>
<pre class="highlight plaintext"><code>its('maxdays') { should eq 99 }
</code></pre>
<p>where <code>99</code> represents the maximum number of days.</p>

<h3>mindays</h3>

<p>The <code>mindays</code> matcher tests the minimum number of days between password changes:</p>
<pre class="highlight plaintext"><code>its('mindays') { should eq 0 }
</code></pre>
<p>where <code>0</code> represents the maximum number of days.</p>

<h3>shell</h3>

<p>The <code>shell</code> matcher tests the path to the default shell for the user:</p>
<pre class="highlight plaintext"><code>its('shell') { should eq '/bin/bash' }
</code></pre>
<h3>uid</h3>

<p>The <code>uid</code> matcher tests the user identifier:</p>
<pre class="highlight plaintext"><code>its('uid') { should eq 1234 } }
</code></pre>
<p>where <code>1234</code> represents the user identifier.</p>

<h3>warndays</h3>

<p>The <code>warndays</code> matcher tests the number of days a user is warned before a password must be changed:</p>
<pre class="highlight plaintext"><code>its('warndays') { should eq 5 }
</code></pre>
<p>where <code>5</code> represents the number of days a user is warned.</p>

<h2>Examples</h2>

<p>The following examples show how to use this InSpec audit resource.</p>

<h3>Use a regular expression to find users</h3>
<pre class="highlight plaintext"><code>describe users.where { uid =~ /S\-1\-5\-21\-\d+\-\d+\-\d+\-500/ } do
  it { should exist }
end
</code></pre></main></div><footer id="main-footer"><div class="container"><div class="row"><div class="columns large-3 medium-4"><div class="footer--logos"><a class="footer--logo chef" href="http://www.chef.io"><img src="/images/chef-logo.png" /></a><a class="footer--logo inspec" href="/"><img src="/images/inspec-by-chef-logo.png" /></a></div></div><div class="columns large-9 medium-8 medium-text-right text-center"><ul class="footer--links"><li><a class="footer--link" href="/legal/licensing">Licensing</a></li><li><a class="footer--link" href="/legal/terms-and-conditions">Terms &amp; Conditions</a></li></ul><ul class="footer--links"><li><a class="footer--link" href="/legal/trademark-policy">Trademark Policy</a></li><li><a class="footer--link" href="/legal/privacy-policy">Privacy Policy</a></li></ul><p><small>&copy; Chef Software 2016</small></p></div></div></div></footer><script src="scripts/inspec_tutorial.js"></script><script src="dist/inspec_tutorial.js"></script><div class="inspec-tutorial" hidden="true" inspec-tutorial="true">Loading</div><script src="/javascripts/all.js"></script><script>$(document).foundation();
$('.try-demo').click(function(event){
  event.stopPropagation();
  $('.inspec-tutorial').show()
  window.dispatchEvent(new Event('resizeTerminal'));
  $('.quit-inspec-tutorial').click(function(event){
    event.stopPropagation();
    $('.inspec-tutorial').hide()
  })
});

javascript:
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
    analytics.load("2NpoxZS2fnBmOgGdnQOymLNm6wuij13X");
    analytics.page()
  }}();</script></body></html>